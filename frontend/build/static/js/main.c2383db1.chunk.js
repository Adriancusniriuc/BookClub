(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{52:function(e,t,a){e.exports=a(82)},64:function(e,t,a){},82:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(45),c=a.n(o),s=a(5),l=a(4),i=a(7),u=a(6),m=a(8),p=a(12),d=a(21),h=a(27),b=function(){function e(){Object(s.a)(this,e)}return Object(l.a)(e,null,[{key:"setToken",value:function(e){localStorage.setItem("token",e)}},{key:"getToken",value:function(){return localStorage.getItem("token")}},{key:"logout",value:function(){localStorage.removeItem("token")}},{key:"getPayload",value:function(){var e=this.getToken();if(!e)return!1;var t=e.split(".");return!(t.length<3)&&JSON.parse(atob(t[1]))}},{key:"isAuthenticated",value:function(){var e=this.getPayload();return!!e&&Math.round(Date.now()/1e3)<e.exp}}]),e}(),v=function(e){var t=e.component,a=Object(h.a)(e,["component"]);return b.isAuthenticated()?r.a.createElement(d.b,Object.assign({},a,{component:t})):(b.logout(),r.a.createElement(d.a,{to:"/login"}))},f=(a(64),function(){return r.a.createElement("section",{className:"home"},r.a.createElement("img",{alt:"home",src:"https://www.werksgroup.org.uk/wp-content/uploads/2018/09/Book-Club.jpg"}))}),g=a(9),E=a.n(g),k=a(10),w=a(14),y=a(11),O=a.n(y),j=(a(42),a(43),a(25)),C=a(49),x=function(e){var t=e.viewport,a=e.handleGeocoderViewportChange,n=e.handleViewportChange,o=e.mapboxToken,c=e.mapRef,s=e.postcodes,l=e.clubs;return r.a.createElement(j.c,Object.assign({mapboxApiAccessToken:o,ref:c},t,{height:"80vh",width:"80vw",mapStyle:"mapbox://styles/mapbox/streets-v11",onViewportChange:n}),r.a.createElement(C.a,{mapRef:c,onViewportChange:a,mapboxApiAccessToken:o}),s.map((function(e,t){return r.a.createElement(j.b,{key:t,latitude:e.result.latitude,longitude:e.result.longitude},l.map((function(t,a){return t.postcode===e.query?r.a.createElement(p.b,{key:a,to:"/clubs/".concat(t.id)},r.a.createElement("div",null,r.a.createElement("img",{className:"marker",alt:"bookclub-marker",src:"https://image.flaticon.com/icons/svg/29/29302.svg"}))):null})))})))},N=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(o)))).state={postcodes:null,clubs:null,viewport:{latitude:51.5074,longitude:.1278,zoom:9}},a.mapboxToken="pk.eyJ1IjoiY3VzbmlyaXVjLWFkcmlhbiIsImEiOiJjazVpOTB5MnkwYjRqM3FvN2RrNGYyNDhqIn0.HU0j2R0LLGcvs8_Osx-luw",a.mapRef=r.a.createRef(),a.handleViewportChange=function(e){a.setState({viewport:Object(w.a)({},a.state.viewport,{},e)})},a.handleGeocoderViewportChange=function(e){return a.setState({viewport:{latitude:e.latitude,longitude:e.longitude,zoom:e.zoom}}),a.handleViewportChange(Object(w.a)({},e,{},{transitionDuration:1e3}))},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,O.a.get("/api/clubs/");case 3:t=e.sent,this.setState({clubs:t.data}),console.log(t.data),this.getPostcodes(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPostcodes",value:function(){var e=Object(k.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.clubs.map((function(e){return e.postcode})),e.next=3,O.a.post("https://cors-anywhere.herokuapp.com/api.postcodes.io/postcodes",{postcodes:t});case 3:a=e.sent,this.setState({postcodes:a.data.result});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return this.state.postcodes&&this.state.clubs?r.a.createElement("section",null,r.a.createElement("div",{className:"index"},r.a.createElement("h1",null,"Find a book club in your area!"),r.a.createElement(p.b,{to:"/clubs/create"},r.a.createElement("button",{className:"button",type:"button"},"Create club"))),r.a.createElement("div",{className:"map-container"},r.a.createElement(x,{viewport:this.state.viewport,handleGeocoderViewportChange:this.handleGeocoderViewportChange,handleViewportChange:this.handleViewportChange,mapboxToken:this.mapboxToken,mapRef:this.mapRef,postcodes:this.state.postcodes,clubs:this.state.clubs}))):null}}]),t}(r.a.Component),S=function(e){var t=e.image,a=e.id,n=e.name;return r.a.createElement("div",{className:"current-book"},r.a.createElement("h2",null,"Current Book:"),r.a.createElement(p.b,{to:"/books/".concat(a)},r.a.createElement("img",{className:"current-book-pic",alt:n,src:t})))},D=function(e){var t=e.image,a=(e.title,e.id),n=e.name;return r.a.createElement(p.b,{to:"/books/".concat(a)},r.a.createElement("img",{className:"prev-book-pic",alt:n,src:t}))},A=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={clubs:null,currentBook:null,previousBooks:null},a.handleDelete=Object(k.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.prev=1,e.next=4,O.a.delete("/api/clubs/".concat(t),{headers:{Authorization:"Bearer ".concat(b.getToken())}});case 4:a.props.history.push("/clubs"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),a.isClubOwner=function(){return b.getPayload().sub===a.state.clubs.user.id},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(E.a.mark((function e(){var t,a,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/clubs/".concat(t,"/"));case 4:a=e.sent,n=a.data,this.setState({clubs:n,currentBook:n.book.slice(-1).pop(),previousBooks:n.book.slice(0,-1)}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){console.log(this.state.currentBook),console.log(this.state.previousBooks);var e=this.state.clubs,t=this.props.match.params.id;return this.state.previousBooks&&this.state.clubs?r.a.createElement("section",null,r.a.createElement("main",{className:"club-show"},r.a.createElement("div",{className:"club-info"},r.a.createElement("h2",null,e.name),r.a.createElement("div",{className:"content"},r.a.createElement("p",null,r.a.createElement("b",null,"We meet at:"),"  ",e.venue,", ",e.postcode),r.a.createElement("p",null,r.a.createElement("b",null,"When?"),"  ",e.date),r.a.createElement("p",null,r.a.createElement("b",null,"A bit about us:"),"  ",e.description)),r.a.createElement("div",{className:"button-div"},r.a.createElement(p.b,{to:"/clubs/".concat(e.id,"/members/")},r.a.createElement("button",null,"Members")),r.a.createElement(p.b,{to:"/clubs/".concat(t,"/books/create/")},r.a.createElement("button",null,"Add Book")),r.a.createElement(p.b,{to:"/clubs/".concat(e.id,"/edit/")},r.a.createElement("button",null,"Edit Club")),r.a.createElement("button",{onClick:this.handleDelete},"Delete Club"))),r.a.createElement(S,this.state.currentBook)),r.a.createElement("h2",null,"Previous Books:"),r.a.createElement("div",{className:"prev-book"},this.state.previousBooks.map((function(e,t){return r.a.createElement(D,Object.assign({key:t},e))})))):null}}]),t}(r.a.Component),B=a(1),V=function(e){var t=e.data,a=e.handleChange,n=e.handleSubmit;return r.a.createElement("section",{className:"form"},r.a.createElement("h1",null,"Club Form"),r.a.createElement("form",{onSubmit:n},r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Name",name:"name",value:t.name,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Venue",name:"venue",value:t.venue,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Postcode",name:"postcode",value:t.postcode,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Date",name:"date",value:t.date,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Description",name:"description",value:t.description})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Maximum available spaces",name:"maxspace",value:t.maxspace,required:!0})),r.a.createElement("div",{className:"button-div"},r.a.createElement("button",{className:"button",type:"submit"},"Submit"))))},T=a(51),q={common:{"X-CSRF-TOKEN":a.n(T).a.get("csrftoken")},headers:{Authorization:"Bearer ".concat(b.getToken())}},I=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={data:{name:"",venue:"",postcode:"",date:"",description:"",maxspace:""}},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value,o=Object(w.a)({},a.state.data,Object(B.a)({},n,r));console.log(o),a.setState({data:o})},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post("/api/clubs/",a.state.data,q);case 4:n=e.sent,a.props.history.push("/clubs/".concat(n.data.id)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("h1",null,"Club Create"),r.a.createElement(V,{data:this.state.data,handleChange:this.handleChange,handleSubmit:this.handleSubmit}))}}]),t}(r.a.Component),R=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={data:{name:"",venue:"",postcode:"",date:"",description:"",maxspace:""}},a.handleChange=function(e){var t=Object(w.a)({},a.state.data,Object(B.a)({},e.target.name,e.target.value));a.setState({data:t})},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.props.match.params.id,e.prev=2,e.next=5,O.a.put("/api/clubs/".concat(n,"/"),a.state.data,q);case 5:r=e.sent,o=r.data,a.props.history.push("/clubs/".concat(o.id)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/clubs/".concat(t,"/"));case 4:a=e.sent,this.setState({data:a.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("h1",null," Club Edit "),r.a.createElement(V,{data:this.state.data,handleChange:this.handleChange,handleSubmit:this.handleSubmit}))}}]),t}(r.a.Component),M=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={image:null},a.handleUpload=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files,(r=new FormData).append("file",n[0]),r.append("upload_preset","px8nzwkd"),e.next=6,O.a.post("https://api.cloudinary.com/v1_1/dhemsdusi/image/upload",r);case 6:o=e.sent,a.setState({image:o.data.url},(function(){a.props.handleChange({target:{name:a.props.fieldName,value:o.data.url}})}));case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.image;return r.a.createElement(r.a.Fragment,null,e?r.a.createElement("div",null,r.a.createElement("img",{alt:"member",src:e})):r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"file",onChange:this.handleUpload})))}}]),t}(r.a.Component),z=function(e){var t=e.data,a=e.handleChange,n=e.handleSubmit;return r.a.createElement("section",{className:"form"},r.a.createElement("form",{onSubmit:n},r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"title",name:"title",value:t.title,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Author",name:"author",value:t.author,required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Genre",name:"genre",value:t.genre})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Number of Pages",name:"no_pages",value:t.no_pages})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:a,placeholder:"Rating",name:"rating",value:t.rating})),r.a.createElement("div",{className:"form-div"},r.a.createElement("label",null,"* required field"),r.a.createElement(M,{labelText:"Upload Image",handleChange:a,fieldName:"image",required:!0})),r.a.createElement("div",{className:"button-div"},r.a.createElement("button",{className:"button",type:"submit"},"Submit"))))},F=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={data:{title:"",author:"",genre:"",no_pages:"",image:"",rating:""}},a.handleChange=function(e){var t=Object(w.a)({},a.state.data,Object(B.a)({},e.target.name,e.target.value));a.setState({data:t})},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.props.match.params.id,e.prev=2,e.next=5,O.a.put("/api/books/".concat(n,"/"),a.state.data,q,{headers:{Authorization:"Bearer ".concat(b.getToken())}});case 5:r=e.sent,o=r.data,a.props.history.push("/books/".concat(o.id)),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(2),console.log(e.t0);case 13:case"end":return e.stop()}}),e,null,[[2,10]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=Object(k.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/books/".concat(t));case 4:a=e.sent,this.setState({data:a.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,this,[[1,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("h1",null,"Make edits to your book"),r.a.createElement(z,{data:this.state.data,handleChange:this.handleChange,handleSubmit:this.handleSubmit}))}}]),t}(r.a.Component),P=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={books:[],club:null,data:{title:"",author:"",genre:"",no_pages:"",image:"",rating:""}},a.getData=Object(k.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/clubs/".concat(t,"/"));case 4:n=e.sent,a.setState({club:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.handleChange=function(e){var t=e.target,n=t.name,r=t.value,o=Object(w.a)({},a.state.data,Object(B.a)({},n,r));console.log(o),a.setState({data:o})},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,n=a.props.match.params.id,console.log(n),e.next=6,O.a.post("/api/books/",a.state.data,q);case 6:r=e.sent,o=r.data,console.log("bookid",o),a.state.club.book.push(o),console.log("book in data",a.state.club.book),a.setState({data:r.data}),a.props.history.push("/books/".concat(r.data.id)),a.addToClub(),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(1),console.log(e.t0);case 19:case"end":return e.stop()}}),e,null,[[1,16]])})));return function(t){return e.apply(this,arguments)}}(),a.addToClub=Object(k.a)(E.a.mark((function e(){var t,n,r,o,c;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,n=a.state.club,console.log(n),r=[],n.member.map((function(e){return r.push(e.id)})),o=[],n.book.map((function(e){return o.push(e.id)})),c={name:n.name,venue:n.venue,postcode:n.postcode,date:n.date,description:n.description,maxspace:n.maxspace,member:r.map((function(e){return e})),book:o.map((function(e){return e})),owner:n.owner},e.prev=8,e.next=11,O.a.put("/api/clubs/".concat(t,"/"),c);case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(8),console.log(e.t0.response.data);case 16:case"end":return e.stop()}}),e,null,[[8,13]])}))),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){return this.state.club?r.a.createElement("section",null,r.a.createElement("h1",null,"Create a Book!"),r.a.createElement(z,{data:this.state.data,handleChange:this.handleChange,handleSubmit:this.handleSubmit})):null}}]),t}(r.a.Component),L=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={books:null,text:""},a.getData=Object(k.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/books/".concat(t));case 4:n=e.sent,a.setState({books:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.handleDelete=Object(k.a)(E.a.mark((function e(){var t;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.prev=1,e.next=4,O.a.delete("/api/books/".concat(t,"/"),{headers:{Authorization:"Bearer ".concat(b.getToken())}});case 4:a.props.history.push("/clubs"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])}))),a.handleChange=function(e){var t=e.target.value;a.setState({text:t})},a.handleSubmitComment=function(){var e=Object(k.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.props.match.params.id,e.prev=2,e.next=5,O.a.post("/api/books/".concat(n,"/comments/"),{text:a.state.text},{headers:{Authorization:"Bearer ".concat(b.getToken())}});case 5:a.setState({text:""}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),console.log(e.t0);case 11:a.getData();case 12:case"end":return e.stop()}}),e,null,[[2,8]])})));return function(t){return e.apply(this,arguments)}}(),a.handleDeleteComment=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=a.props.match.params.id,r=t.target.name,e.prev=3,e.next=6,O.a.delete("/api/books/".concat(n,"/comments/").concat(r,"/"),{headers:{Authorization:"Bearer ".concat(b.getToken())}});case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),console.log(e.t0);case 11:a.getData();case 12:case"end":return e.stop()}}),e,null,[[3,8]])})));return function(t){return e.apply(this,arguments)}}(),a.isClubOwner=function(){return b.getPayload().sub===a.state.clubs.user.id},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){var e=this;if(!this.state.books)return null;var t=this.state.text;return console.log("hello",this.state.books),r.a.createElement("section",null,r.a.createElement("main",{className:"bookshow"},r.a.createElement("div",{className:"book"},r.a.createElement("img",{className:"bookshow-img",alt:this.state.books.title,src:this.state.books.image}),r.a.createElement("div",null,r.a.createElement(p.b,{to:"/books/".concat(this.state.books.id,"/edit/")},r.a.createElement("button",null,"Edit Book")),r.a.createElement("button",{onClick:this.handleDelete},"Delete Book"))),r.a.createElement("div",{className:"comments"},this.state.books.comments.map((function(t,a){return r.a.createElement("div",{className:"comment-del"},r.a.createElement("p",{key:a},t.text),r.a.createElement("button",{onClick:e.handleDeleteComment,name:t.id,type:"submit",className:"button"},"Delete comment"))})),r.a.createElement("form",{className:"review-form",onSubmit:this.handleSubmitComment},r.a.createElement("div",null,r.a.createElement("textarea",{className:"review-textarea",placeholder:"Add a comment",onChange:this.handleChange,value:t})),r.a.createElement("div",null,r.a.createElement("button",{className:"button",type:"submit"},"Add"))))))}}]),t}(r.a.Component),_=Object(d.g)(L),G=function(e){var t=e.username,a=e.image;return r.a.createElement("div",{className:"member-card"},r.a.createElement("img",{className:"member-pic",alt:"member",src:a}),r.a.createElement("p",null,t))},J=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={clubs:{name:"",venue:"",postcode:"",date:"",description:"",maxspace:"",member:[],book:[],owner:{}}},a.getData=Object(k.a)(E.a.mark((function e(){var t,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.props.match.params.id,e.prev=1,e.next=4,O.a.get("/api/clubs/".concat(t,"/"));case 4:n=e.sent,a.setState({members:n.data.member,clubs:n.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,8]])}))),a.handleClick=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n=b.getPayload().sub,r=a.state.members,e.prev=3,e.next=6,O.a.get("/api/user/",q);case 6:o=e.sent,c=r.filter((function(e){return e.id===n})),s=r.indexOf(c),r.some((function(e){return e.id===n}))?r.splice(s,1):r.push(o.data),a.setState({members:r}),a.handleSubmit(),e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),console.log(e.t0);case 17:case"end":return e.stop()}}),e,null,[[3,14]])})));return function(t){return e.apply(this,arguments)}}(),a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n,r,o,c,s;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.props.match.params.id,r=a.state.clubs,o=[],r.member.map((function(e){return o.push(e.id)})),c=[],r.book.map((function(e){return c.push(e.id)})),s={name:r.name,venue:r.venue,postcode:r.postcode,date:r.date,description:r.description,maxspace:r.maxspace,member:o.map((function(e){return e})),book:c.map((function(e){return e})),owner:r.owner},e.prev=7,e.next=10,O.a.put("/api/clubs/".concat(n,"/"),s,q);case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(7),console.log(e.t0.response.data);case 15:case"end":return e.stop()}}),e,null,[[7,12]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getData()}},{key:"render",value:function(){if(!this.state.members)return null;var e=b.getPayload().sub;return console.log(e),r.a.createElement("section",null,r.a.createElement("h1",null,"These are our members!"),r.a.createElement("div",{className:"member-index"},this.state.members.map((function(e,t){return r.a.createElement(G,Object.assign({key:t},e))}))),r.a.createElement("form",{className:"buttons"},this.state.members.some((function(t){return t.id===e}))?r.a.createElement("button",{type:"button",className:"button",onClick:this.handleClick},"Leave Team"):r.a.createElement("button",{type:"button",className:"button",onClick:this.handleClick},"Join Team")))}}]),t}(r.a.Component),U=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={data:{email:"",password:""}},a.handleChange=function(e){var t=e.target,n=t.name,r=t.value,o=Object(w.a)({},a.state.data,Object(B.a)({},n,r));a.setState({data:o})},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){var n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post("/api/login",a.state.data);case 4:n=e.sent,b.setToken(n.data.token),console.log(n.data),a.props.history.push("/"),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),a.setState({error:"Invalid Credentials"});case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("h1",null,"Login Here"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{type:"email",placeholder:"email",name:"email",onChange:this.handleChange})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{type:"password",placeholder:"password",name:"password",onChange:this.handleChange})),r.a.createElement("div",{className:"button-div"},r.a.createElement("button",{className:"button",type:"submit"},"Login"))))}}]),t}(r.a.Component),W=function(e){var t=e.formErrors;return r.a.createElement("div",{className:"formErrors"},Object.keys(t).map((function(e,a){return t[e].length>0?r.a.createElement("p",{key:a},e," ",t[e]):""})))},H=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={data:{username:"",email:"",password:"",password_confirmation:"",bio:""},emailValid:!1,formValid:!1,passwordValid:!1,formErrors:{email:"",password:""}},a.handleChange=function(e){var t=e.target.name,n=e.target.value,r=Object(w.a)({},a.state.data,Object(B.a)({},t,n));a.setState({data:r},(function(){a.validateField(t,n)}))},a.handleSubmit=function(){var e=Object(k.a)(E.a.mark((function e(t){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,O.a.post("/api/register",a.state.data);case 4:a.props.history.push("/login"),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}(),a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"validateField",value:function(e,t){var a=this.state.formErrors,n=this.state.emailValid,r=this.state.passwordValid;switch(e){case"email":n=t.match(/^([\w.%+-]+)@([\w-]+\.)+([\w]{2,})$/i),a.email=n?"":" is invalid";break;case"password":r=t.length>=1,a.password=r?"":" is too short"}this.setState({formErrors:a,emailValid:n,passwordValid:r},this.validateForm)}},{key:"validateForm",value:function(){this.setState({formValid:this.state.emailValid&&this.state.passwordValid})}},{key:"errorClass",value:function(e){return 0===e.length?"":"has-error"}},{key:"render",value:function(){return r.a.createElement("section",null,r.a.createElement("main",{className:"register"},r.a.createElement("h1",null,"Register"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",null,r.a.createElement(W,{formErrors:this.state.formErrors})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:this.handleChange,placeholder:"username",name:"username",required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:this.handleChange,type:"email",placeholder:"email",name:"email",required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:this.handleChange,type:"password",placeholder:"password",name:"password",required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("input",{onChange:this.handleChange,type:"password",placeholder:"confirm password",name:"password_confirmation",required:!0})),r.a.createElement("div",{className:"form-div"},r.a.createElement("textarea",{rows:"5",cols:"30",onChange:this.handleChange,placeholder:"Bio",name:"bio"})),r.a.createElement("div",{className:"form-div"},r.a.createElement(M,{handleChange:this.handleChange,fieldName:"image"})),r.a.createElement("div",{className:"button-div"},r.a.createElement("button",{className:"button",type:"submit",disabled:!this.state.formValid},"Register")))))}}]),t}(r.a.Component),Y=function(e){function t(){var e,a;Object(s.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={loggedIn:!1},a.toggleNavbar=function(){a.setState({loggedIn:!a.state.loggedIn})},a.handleLogout=function(){b.logout(),a.props.history.push("/")},a}return Object(m.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.location.pathname!==e.location.pathname&&this.setState({loggedIn:!0})}},{key:"render",value:function(){return r.a.createElement("nav",{className:"nav"},r.a.createElement(p.b,{to:"/"},"Home"),r.a.createElement(p.b,{to:"/clubs"},"Clubs"),!b.isAuthenticated()&&r.a.createElement(p.b,{to:"/login"},"Login"),!b.isAuthenticated()&&r.a.createElement(p.b,{to:"/register"},"Register"),b.isAuthenticated()&&r.a.createElement("span",{onClick:this.handleLogout},r.a.createElement(p.b,{className:"nav-item",to:"/"},"Logout")))}}]),t}(r.a.Component),X=Object(d.g)(Y),$=function(e){function t(){return Object(s.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,null,r.a.createElement(X,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:f}),r.a.createElement(v,{path:"/clubs/:id/books/create",component:P}),r.a.createElement(d.b,{path:"/clubs/:id/members",component:J}),r.a.createElement(v,{path:"/clubs/:id/edit",component:R}),r.a.createElement(v,{path:"/clubs/create",component:I}),r.a.createElement(d.b,{path:"/clubs/:id",component:A}),r.a.createElement(d.b,{path:"/clubs",component:N}),r.a.createElement(v,{path:"/books/:id/edit",component:F}),r.a.createElement(d.b,{path:"/books/:id",component:_}),r.a.createElement(d.b,{path:"/login",component:U}),r.a.createElement(d.b,{path:"/register",component:H})))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[52,1,2]]]);
//# sourceMappingURL=main.c2383db1.chunk.js.map